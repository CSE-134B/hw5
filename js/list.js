function authDataCallback(a){a?(uId=a.uid,cHabitsRef=oFirebaseRef.child("users/"+uId+"/currentHabit"),oHabitsRef=oFirebaseRef.child("/users/"+uId+"/habits")):(Rollbar.info("Unauthorized user attempted to access page",{page:"list.html"}),window.location="login.html")}function done(a){var b=oFirebaseRef.child("users/"+uId+"/habits"),c=a.parentNode.parentNode,d=c.getElementsByTagName("progress"),e=d[0],f="",f=a.parentNode.previousElementSibling.previousElementSibling.firstElementChild.firstElementChild.innerHTML;b.orderByChild("title").equalTo(f).once("value",function(c){a.parentNode.previousElementSibling.firstElementChild.nextElementSibling.nextElementSibling.style.visibility="visible",c.forEach(function(c){var d=c.val(),f=d.daily_frequency,g=d.numCompleted,h=g+1;b.child(c.key()).update({numCompleted:h});var i=new Firebase("http://boiling-torch-2236.firebaseIO.com/web/users/"+uId+"/notifications/"+c.key()),j=Date.now();i.update({last_updated:j}),h>=f?(a.parentNode.previousElementSibling.firstElementChild.nextElementSibling.nextElementSibling.innerHTML="Completed Habit!",animator(e,100,100),mixpanel.track("Completed a Habit")):(a.parentNode.previousElementSibling.firstElementChild.nextElementSibling.nextElementSibling.firstElementChild.innerHTML=h,a.parentNode.previousElementSibling.firstElementChild.nextElementSibling.nextElementSibling.firstElementChild.nextElementSibling.innerHTML=f,animator(e,h,f),mixpanel.track("Did a Habit"))})})}function deleteHabit(a){for(aChildren=a.parentNode.parentNode.childNodes,i=0;i<aChildren.length;i++)if("habit-id"==aChildren[i].className)var b=aChildren[i].getAttribute("data-habitId");swal({title:"Delete Habit?",text:"Are you sure you want to delete this habit?",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Yes, delete it!",closeOnConfirm:!1},function(){var c=a.parentNode.parentNode.parentNode;c.className=c.className+" animated fadeOutLeft",$(c).one("animationend webkitAnimationEnd MSAnimationEnd oAnimationEnd",function(a){$(this).remove()});var d=(a.previousElementSibling.innerHTML,new Firebase("http://boiling-torch-2236.firebaseIO.com/web/users/"+uId+"/habits/"+b)),e=new Firebase("http://boiling-torch-2236.firebaseIO.com/web/users/"+uId+"/notifications/"+b);d.remove(),e.remove(),swal({title:"Deleted!",text:"Habit successfully deleted.",timer:800,showConfirmButton:!1}),mixpanel.track("Deleted a Habit")})}function editHabit(a){var b=a.previousElementSibling.previousElementSibling.innerHTML;for(var c in data)if(data[c].title==b){currentKey=c;break}cHabitsRef.set({key:currentKey}),mixpanel.track("Habit Edited"),location.href="edit.html"}var oFirebaseRef=new Firebase("http://boiling-torch-2236.firebaseIO.com/web/"),cHabitsRef,oHabitsRef;oFirebaseRef.onAuth(authDataCallback),window.onload=function(){var a=document.getElementById("habit-list"),b=0;oHabitsRef.once("value",function(c){var d=[],e=[],f=[],g=[],h=[],j=[],k=[],l=[],m=[];for(document.querySelector("#noHabits").style.display="none",c.forEach(function(a,c){var i=a.val();d[b]=i.bestRecord,e[b]=i.daily_frequency,f[b]=i.daysInARow,g[b]=i.description,h[b]=i.icon,j[b]=i.title,k[b]=i.weekly_frequency,l[b]=i.numCompleted,m[b]=a.key(),b++}),i=0;i<b;i++){var n=document.getElementById("habits").content.cloneNode(!0);a.appendChild(n),document.getElementsByClassName("habit-name")[i].innerHTML=j[i],document.getElementsByClassName("habit-icon")[i].src=".."+h[i],document.getElementsByClassName("habit-desc")[i].innerHTML=g[i],document.getElementsByClassName("completed")[i].innerHTML=l[i],document.getElementsByClassName("totalNum")[i].innerHTML=e[i],document.getElementsByClassName("habit-days-in-a-row")[i].innerHTML=f[i],document.getElementsByClassName("habit-best-record")[i].innerHTML=d[i],document.getElementsByClassName("habit-id")[i].setAttribute("data-habitId",m[i]),a.appendChild(n)}0==b&&(document.querySelector("#noHabits").style.display="block"),document.querySelector("#logOut").onclick=function(){oFirebaseRef.unauth(),window.location("login.html")}})};var animator=function(a,b,c){var d=1e3/60,e=3,f=b/c*a.getAttribute("max")/(1e3*e/d);a.value=a.value+f,a.value+f<b/c*a.getAttribute("max")?setTimeout(animator(a,b,c),d):a.value=b/c*a.getAttribute("max")},data=null;oHabitsRef.once("value",function(a){data=a.val()});