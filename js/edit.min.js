function authDataCallback(a){a?(uId=a.uid,cHabitsRef=oFirebaseRef.child("users/"+uId+"/currentHabit"),oHabitsRef=oFirebaseRef.child("users/"+uId+"/habits"),populateFields()):(Rollbar.info("Unauthorized user attempted to access page",{page:"edit.min.html"}),window.location="login.min.html")}function selectImage(a){document.getElementById("icon1").style.border="none",document.getElementById("icon2").style.border="none",document.getElementById("icon3").style.border="none",document.getElementById("icon1").setAttribute("data-active","false"),document.getElementById("icon2").setAttribute("data-active","false"),document.getElementById("icon3").setAttribute("data-active","false");var b=document.getElementById(a);b.style.border="5px solid #42A5F5",b.setAttribute("data-active","true")}function populateFields(){cHabitsRef.once("value",function(a){var b=a.val();oHabitsRef=oHabitsRef.child(b.key),oHabitsRef.once("value",function(a){var b=a.val();document.getElementById("title").value=b.title,document.getElementById("description").value=b.description,document.getElementById("title").value=b.title,"/img/sleep.jpg"==b.icon?selectImage("icon1"):"/img/salad.jpg"==b.icon?selectImage("icon2"):"/img/run.jpg"==b.icon?selectImage("icon3"):"/img/add.png"==b.icon&&selectImage("icon4");for(var c="",d=document.getElementsByClassName("weekly-freq"),e=document.getElementsByClassName("daily-freq"),f=0;f<b.weekly_frequency.length;f++)if(","==b.weekly_frequency[f]){for(var g=0;g<d.length;g++)if(d[g].value==c){d[g].checked=!0;break}c=""}else c+=b.weekly_frequency[f];switch(b.daily_frequency){case 1:e[0].checked=!0;break;case 2:e[1].checked=!0;break;case 3:e[2].checked=!0}})})}var currentKey="",flag=null,oFirebaseRef=new Firebase("http://boiling-torch-2236.firebaseIO.com/web/"),oHabitsRef,cHabitsRef;oFirebaseRef.onAuth(authDataCallback);var uId=0;document.querySelector("#save_p").onclick=function(){if(!$("#title").val())return void(document.getElementById("noTitle").style.display="");if(!$("input:checkbox").is(":checked"))return void(document.getElementById("noWFreq").style.display="");if(!$("input:radio").is(":checked")){if(!$("#others").val())return void(document.getElementById("noDFreq").style.display="");if($("#others").val()<$("#others").attr("min"))return void swal("Oops!","Please enter a valid Daily Frequency","error")}$("input:radio").is(":checked")&&($("#others").val()>3?$("input:radio").prop("checked",!1):$("#others").attr("value","0")),"false"==document.getElementById("icon1").getAttribute("data-active")&&"false"==document.getElementById("icon2").getAttribute("data-active")&&"false"==document.getElementById("icon3").getAttribute("data-active")&&document.getElementById("icon4").setAttribute("data-active","true"),cHabitsRef.once("value",function(a){for(var b=a.val(),c=document.getElementsByClassName("icon"),d="",e=0;e<c.length;e++)"true"==c[e].getAttribute("data-active")&&(d=c[e].src.substring(c[e].src.indexOf("/img/"),c[e].src.length));for(var f=document.querySelector("#title").value,g=d,h="",i=0,j=0,k=0,l=0,m=document.querySelector("#description").value,n=(document.querySelector("#others").value,document.getElementsByClassName("weekly-freq")),o=document.getElementsByClassName("daily-freq"),e=0;e<n.length;e++)n[e].checked&&(h+=n[e].value+",");for(var e=0;e<o.length;e++)o[e].checked&&(i=parseInt(o[e].value));oHabitsRef=oHabitsRef.child(b.key),sHabitId=oHabitsRef.key(),oHabitsRef.set({title:f,icon:g,weekly_frequency:h,daily_frequency:i,description:m,bestRecord:j,daysInARow:k,numCompleted:l});var p=oFirebaseRef.child("users/"+uId+"/notifications"),q=Date.now(),r=p.child(sHabitId);r.set({habitTitle:f,weekly_frequency:h,daily_frequency:i,last_updated:q}),location.href="list.min.html"})},document.querySelector("#logOut").onclick=function(){oFirebaseRef.unauth(),window.location("login.min.html")};